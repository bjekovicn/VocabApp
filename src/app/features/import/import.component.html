<div class="min-h-screen bg-gray-50 p-6">
  <div class="max-w-2xl mx-auto">
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-gray-900 mb-2">Importuj Reƒçi</h1>
      <p class="text-gray-600">Nalepi JSON ili uploaduj fajl</p>
    </div>

    <app-custom-card>
      <div class="space-y-8">
        <!-- MODE SWITCH -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-3">
            Izaberi naƒçin importa
          </label>

          <div class="flex gap-4">
            <label
              class="flex-1 cursor-pointer border rounded-lg p-4 text-center transition-all"
              [class.border-blue-500]="importMode() === 'paste'"
              [class.bg-blue-50]="importMode() === 'paste'"
            >
              <input
                type="radio"
                class="hidden"
                name="importMode"
                value="paste"
                [checked]="importMode() === 'paste'"
                (change)="importMode.set('paste'); selectedFile.set(null)"
              />
              ‚úèÔ∏è Paste JSON
            </label>

            <label
              class="flex-1 cursor-pointer border rounded-lg p-4 text-center transition-all"
              [class.border-blue-500]="importMode() === 'file'"
              [class.bg-blue-50]="importMode() === 'file'"
            >
              <input
                type="radio"
                class="hidden"
                name="importMode"
                value="file"
                [checked]="importMode() === 'file'"
                (change)="importMode.set('file'); pastedJson.set('')"
              />
              üìÅ Upload fajl
            </label>
          </div>
        </div>

        <!-- PASTE -->
        @if (importMode() === 'paste') {
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"> Nalepi JSON </label>

            <textarea
              rows="10"
              [value]="pastedJson()"
              (input)="pastedJson.set($any($event.target).value)"
              placeholder="Ovde nalepi JSON..."
              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none font-mono text-sm"
            ></textarea>
          </div>
        }

        <!-- FILE -->
        @if (importMode() === 'file') {
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"> JSON Fajl </label>

            <input
              type="file"
              accept=".json,application/json"
              (change)="handleFileSelect($event)"
              class="block w-full text-sm text-gray-900 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            />

            @if (selectedFile()) {
              <div
                class="mt-3 p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800"
              >
                {{ selectedFile()!.name }}
              </div>
            }
          </div>
        }

        <!-- LIST SELECT -->
        <app-custom-select
          label="Ciljana Lista"
          placeholder="Izaberi listu"
          [options]="listOptions()"
          [required]="true"
          [value]="selectedListId()"
          (valueChange)="selectedListId.set($event)"
        />

        <!-- ERRORS -->
        @if (errors().length > 0) {
          <div class="bg-red-50 border border-red-200 rounded-lg p-4">
            <ul class="list-disc list-inside text-sm text-red-700">
              @for (error of errors(); track $index) {
                <li>{{ error }}</li>
              }
            </ul>
          </div>
        }

        <!-- SUCCESS -->
        @if (successCount() > 0) {
          <div
            class="bg-green-50 border border-green-200 rounded-lg p-4 text-green-800 text-sm font-semibold"
          >
            ‚úÖ Uspe≈°no importovano {{ successCount() }} reƒçi!
          </div>
        }

        <!-- BUTTONS -->
        <div class="flex gap-4 pt-4">
          <app-custom-button
            variant="primary"
            [fullWidth]="true"
            [disabled]="!canImport()"
            (clicked)="handleImport()"
          >
            @if (isImporting()) {
              Importovanje...
            } @else {
              Importuj Reƒçi
            }
          </app-custom-button>

          <app-custom-button
            variant="secondary"
            [fullWidth]="true"
            [disabled]="isImporting()"
            (clicked)="handleCancel()"
          >
            Otka≈æi
          </app-custom-button>
        </div>
      </div>
    </app-custom-card>

    <!-- AI PROMPT -->
    <div class="mt-10">
      <div class="flex justify-between items-center mb-3">
        <h2 class="text-lg font-semibold text-gray-900">ü§ñ AI Generator Prompt</h2>

        <button
          (click)="copyFullPrompt()"
          class="px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm"
        >
          üìã Kopiraj kompletan prompt
        </button>
      </div>

      <div
        class="bg-gray-900 text-green-400 text-xs p-4 rounded-lg overflow-x-auto whitespace-pre-wrap font-mono"
      >
        {{ aiFullPrompt }}
      </div>
    </div>
  </div>
</div>
